{% extends 'base.html' %}

{% block title %}{{ post.title }} | Aesthetics Clinic{% endblock %}

{% block content %}
<section class="py-16">
  <div class="container mx-auto px-4 max-w-7xl grid grid-cols-1 lg:grid-cols-12 gap-10">
    
    <!-- Main Blog Content -->
    <article class="lg:col-span-8">
      <div class="mb-6 text-sm text-gray-500 flex flex-wrap gap-4 items-center">
        {% if post.category %}
          <a href="{% url 'blog_category' post.category.slug %}" class="px-3 py-1 bg-pink-100 text-pink-600 rounded-full text-xs font-medium hover:bg-pink-200 transition">{{ post.category.name }}</a>
        {% endif %}
        <span><i class="far fa-calendar-alt mr-1"></i>{{ post.created_at|date:"F j, Y" }}</span>
        <span><i class="far fa-user mr-1"></i>{{ post.author.get_full_name|default:post.author.username }}</span>
      </div>

      <h1 class="text-4xl font-semibold text-gray-800 leading-tight mb-10">{{ post.title }}</h1>

      {% if post.featured_image %}
        <img src="{{ post.featured_image.url }}" alt="{{ post.title }}" class="w-full rounded-xl shadow mb-10">
      {% else %}
        <img src="/static/images/blog/placeholder.jpg" alt="{{ post.title }}" class="w-full rounded-xl shadow mb-10">
      {% endif %}

      <div class="prose lg:prose-lg max-w-none text-gray-700 mb-10">
        {{ post.content|safe }}
      </div>

      {% if post.tags.all %}
      <div class="mb-10">
        <span class="block text-sm font-medium text-gray-600 mb-2">Tags:</span>
        <div class="flex flex-wrap gap-2">
          {% for tag in post.tags.all %}
            <a href="{% url 'blog_tag' tag.slug %}" class="text-sm px-3 py-1 bg-gray-100 rounded-full hover:bg-gray-200 transition">{{ tag.name }}</a>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <div class="flex items-center gap-4 mb-12">
        <span class="text-gray-600 text-sm font-medium">Share:</span>
        <div class="flex gap-3">
          <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank" class="text-blue-600 hover:text-blue-800"><i class="fab fa-facebook-f"></i></a>
          <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text={{ post.title|urlencode }}" target="_blank" class="text-sky-500 hover:text-sky-700"><i class="fab fa-twitter"></i></a>
          <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ request.build_absolute_uri }}&title={{ post.title|urlencode }}" target="_blank" class="text-blue-700 hover:text-blue-900"><i class="fab fa-linkedin-in"></i></a>
          <a href="mailto:?subject={{ post.title|urlencode }}&body={{ post.excerpt|urlencode }}%0A%0A{{ request.build_absolute_uri }}" class="text-gray-600 hover:text-gray-800"><i class="far fa-envelope"></i></a>
        </div>
      </div>

      <div class="flex items-center gap-6 bg-gray-50 p-6 rounded-xl mb-16 shadow-sm">
        <div class="w-16 h-16 rounded-full overflow-hidden">
          {% if post.author.profile.avatar %}
            <img src="{{ post.author.profile.avatar.url }}" alt="{{ post.author.get_full_name }}" class="w-full h-full object-cover">
          {% else %}
            <img src="/static/img/avatar-placeholder.jpg" alt="{{ post.author.get_full_name }}" class="w-full h-full object-cover">
          {% endif %}
        </div>
        <div>
          <h3 class="text-lg font-semibold">{{ post.author.get_full_name|default:post.author.username }}</h3>
          <p class="text-sm text-gray-600">{% if post.author.profile.bio %}{{ post.author.profile.bio }}{% else %}Aesthetics specialist and contributor at our clinic.{% endif %}</p>
        </div>
      </div>

      <div class="flex flex-col lg:flex-row justify-between gap-6 mb-20">
        {% if previous_post %}
          <a href="{% url 'blog_detail' previous_post.slug %}" class="block p-4 rounded-xl bg-white shadow hover:shadow-md transition w-full">
            <span class="text-sm text-pink-500 font-medium flex items-center gap-1"><i class="fas fa-arrow-left"></i> Previous Article</span>
            <h4 class="text-gray-800 mt-1">{{ previous_post.title|truncatechars:40 }}</h4>
          </a>
        {% endif %}
        {% if next_post %}
          <a href="{% url 'blog_detail' next_post.slug %}" class="block p-4 rounded-xl bg-white shadow hover:shadow-md transition w-full text-right">
            <span class="text-sm text-pink-500 font-medium flex justify-end items-center gap-1">Next Article <i class="fas fa-arrow-right"></i></span>
            <h4 class="text-gray-800 mt-1">{{ next_post.title|truncatechars:40 }}</h4>
          </a>
        {% endif %}
      </div>
    </article>

    <!-- Sidebar -->
    <aside class="lg:col-span-4 space-y-10">
      <!-- About Widget -->
      <div class="bg-white p-6 rounded-xl shadow">
        <h3 class="text-xl font-semibold text-gray-800 mb-3">About Us</h3>
        <p class="text-sm text-gray-600">Our aesthetics clinic provides premium non-surgical treatments to enhance your natural beauty.</p>
        <a href="{% url 'about' %}" class="inline-block mt-4 px-4 py-2 bg-pink-500 text-white text-sm rounded-full hover:bg-pink-600 transition">Learn More</a>
      </div>

      <!-- Recent Posts Widget -->
      <div class="bg-white p-6 rounded-xl shadow">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">Recent Articles</h3>
        <div class="space-y-4">
          {% for recent_post in recent_posts %}
          <div class="flex items-start gap-4">
            <div class="w-16 h-16 rounded overflow-hidden flex-shrink-0">
              {% if recent_post.featured_image %}
                <img src="{{ recent_post.featured_image.url }}" alt="{{ recent_post.title }}" class="w-full h-full object-cover">
              {% else %}
                <img src="/static/images/blog/placeholder-small.jpg" alt="{{ recent_post.title }}" class="w-full h-full object-cover">
              {% endif %}
            </div>
            <div>
              <h4 class="text-sm font-medium text-gray-800"><a href="{% url 'blog_detail' recent_post.slug %}">{{ recent_post.title|truncatechars:50 }}</a></h4>
              <span class="text-xs text-gray-500">{{ recent_post.created_at|date:"F j, Y" }}</span>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>

      <!-- CTA Widget -->
      <div class="bg-pink-100 p-6 rounded-xl text-center shadow">
        <h3 class="text-xl font-semibold text-pink-800 mb-2">Ready for a Consultation?</h3>
        <p class="text-sm text-pink-700 mb-4">Book a session with our specialists to discuss your treatment options.</p>
        <a href="{% url 'contact' %}" class="inline-block px-4 py-2 bg-pink-600 text-white rounded-full hover:bg-pink-700 transition">Book Consultation</a>
      </div>
    </aside>
  </div>

  <!-- Related Posts Section -->
  {% if related_posts %}
  <div class="container mx-auto px-4 max-w-7xl mt-20">
    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Related Articles</h2>
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
      {% for related_post in related_posts %}
      <article class="bg-white rounded-xl shadow hover:shadow-md transition overflow-hidden">
        {% if related_post.featured_image %}
          <img src="{{ related_post.featured_image.url }}" alt="{{ related_post.title }}" class="w-full h-48 object-cover">
        {% else %}
          <img src="/static/images/blog/placeholder.jpg" alt="{{ related_post.title }}" class="w-full h-48 object-cover">
        {% endif %}
        <div class="p-5">
          <h3 class="text-lg font-semibold text-gray-800 mb-2"><a href="{% url 'blog_detail' related_post.slug %}">{{ related_post.title }}</a></h3>
          <div class="text-sm text-gray-500 mb-2"><i class="far fa-calendar-alt mr-1"></i>{{ related_post.created_at|date:"F j, Y" }}</div>
          <p class="text-sm text-gray-600 mb-3">{{ related_post.excerpt|truncatewords:15 }}</p>
          <a href="{% url 'blog_detail' related_post.slug %}" class="inline-flex items-center text-pink-500 hover:text-pink-700 text-sm">Read More <i class="fas fa-arrow-right ml-1"></i></a>
        </div>
      </article>
      {% endfor %}
    </div>
  </div>
  {% endif %}
</section>
{% endblock %}

{% block extra_css %}
{% endblock %}
